---
import LanguageSwitcher from './LanguageSwitcher.astro';
import ThemeToggle from './ThemeToggle.astro';
import { getLangFromUrl, useTranslations, getRouteForLang } from '../i18n/index';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
const navItems = [
  { key: 'home', label: t('nav.home') },
  { key: 'projects', label: t('nav.projects') },
  { key: 'articles', label: t('nav.articles') },
  { key: 'recommendations', label: t('nav.recommendations') },
  { key: 'materials', label: t('nav.materials') },
  { key: 'about', label: t('nav.about') },
  { key: 'contact', label: t('nav.contact') },
];
---
<header class="sticky top-0 z-50 bg-white/90 dark:bg-navy-950/90 backdrop-blur border-b border-slate-200 dark:border-slate-700">
  <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
    <a href={getRouteForLang(lang, 'home')} class="text-xl font-bold text-navy-700 dark:text-white hover:text-navy-500 transition-colors">
      SÃ©rgio Carvalho
    </a>
    <nav class="hidden md:flex items-center gap-6">
      {navItems.map(item => (
        <a href={getRouteForLang(lang, item.key)} class="text-slate-600 dark:text-slate-300 hover:text-navy-600 dark:hover:text-white text-sm font-medium transition-colors">
          {item.label}
        </a>
      ))}
    </nav>
    <div class="flex items-center gap-3">
      <LanguageSwitcher />
      <ThemeToggle />
      <button id="menu-btn" class="md:hidden p-2 rounded text-slate-600 dark:text-slate-300" aria-label="Menu">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </button>
    </div>
  </div>
  <nav id="mobile-nav" class="hidden md:hidden border-t border-slate-200 dark:border-slate-700 bg-white dark:bg-navy-950 px-4 py-3 flex flex-col gap-3">
    {navItems.map(item => (
      <a href={getRouteForLang(lang, item.key)} class="text-slate-600 dark:text-slate-300 hover:text-navy-600 dark:hover:text-white text-sm font-medium py-1 transition-colors">
        {item.label}
      </a>
    ))}
  </nav>
</header>
<script>
  const btn = document.getElementById('menu-btn');
  const nav = document.getElementById('mobile-nav');
  btn?.addEventListener('click', () => nav?.classList.toggle('hidden'));
</script>
